---
title: "Be-Healthy"
author: "Pooja Rathee"
output:
  pdf_document: default
date: '2022-04-08'
---

## First we install required packages and go through them

```{r}
library(tidyverse)
library(ggplot2) 
library(scales)


```

#Importing the required data

```{r}

Activity <- read.csv("data/dailyActivity_merged.csv")
Calories<- read.csv("data/hourlyCalories_merged.csv")
Intensities <- read.csv("data/hourlyIntensities_merged.csv")
sleepDay <- read.csv("data/sleepDay_merged.csv")
weight <- read.csv("data/weightLogInfo_merged.csv")

```

## A quick look in the following columns

```{r}
colnames(Activity)
colnames(Calories)
colnames(Intensities)
colnames(sleepDay)
colnames(weight)

```
# Run the Head function

```{r}
head(Activity)
head(Calories)
head(Intensities)
head(sleepDay)
head(weight)
```

## Take a look at the following data and format as date and time

```{r}
# intensities
Intensities$ActivityHour=as.POSIXct(Intensities$ActivityHour, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
Intensities$time <- format(Intensities$ActivityHour, format = "%H:%M:%S")
Intensities$date <- format(Intensities$ActivityHour, format = "%m/%d/%y")
# calories
Calories$ActivityHour=as.POSIXct(Calories$ActivityHour, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
Calories$time <- format(Calories$ActivityHour, format = "%H:%M:%S")
Calories$date <- format(Calories$ActivityHour, format = "%m/%d/%y")
# activity
Activity$ActivityDate=as.POSIXct(Activity$ActivityDate, format="%m/%d/%Y", tz=Sys.timezone())
Activity$date <- format(Activity$ActivityDate, format = "%m/%d/%y")
# sleep
sleepDay$SleepDay=as.POSIXct(sleepDay$SleepDay, format="%m/%d/%Y %I:%M:%S %p", tz=Sys.timezone())
sleepDay$date <- format(sleepDay$SleepDay, format = "%m/%d/%y")
# weight
weight$Date <- format(weight$Date, format = "%m/%d/%y")
weight$time <- format(weight$Date, format = "%H:%M:%S")
```

# Identify all the observations with respect to their Id's

```{r}
n_distinct(Activity$Id)
n_distinct(Calories$Id)
n_distinct(Intensities$Id)
n_distinct(sleepDay$Id)
n_distinct(weight$Id)

```

# Take a look at the summary of the following files

```{r}
# activity
Activity %>%  
  select(TotalSteps,
         TotalDistance,
         SedentaryMinutes, Calories) %>%
  summary()

# explore num of active minutes per category
Activity %>%
  select(VeryActiveMinutes, FairlyActiveMinutes, LightlyActiveMinutes) %>%
  summary()

# calories
Calories %>%
  select(Calories) %>%
  summary()
# sleep
sleepDay %>%
  select(TotalSleepRecords, TotalMinutesAsleep, TotalTimeInBed) %>%
  summary()
# weight
weight %>%
  select(WeightKg, BMI) %>%
  summary()
```

# Merging the data of sleepDay and Activity by Id and date

```{r}
merged_data <- merge(sleepDay, Activity, FUN=c("Id", "date"))
head(merged_data)
```

# Understanding some summary statistics by visualization

```{r distinct users}
ggplot(data=Activity, aes(x=TotalSteps, y=Calories)) + 
  geom_point() + geom_smooth() + labs(title="Total Steps vs. Calories")



```
# There is a positive correlation between Total Steps and Calories, which is obvious - the more active we are, the more calories we burn.
# Let's Visualize the sleepDay dataframe
```{r}
ggplot(data=sleepDay, aes(x=TotalMinutesAsleep, y=TotalTimeInBed)) + 
  geom_point()+ labs(title="Total Minutes Asleep vs. Total Time in Bed")
```
# The relationship between Total Minutes Asleep and Total Time in Bed looks linear. So if the Bellabeat users want to improve their sleep, we should consider using notification to go to sleep.

# Again, intensities
```{r observations}
int_new <- Intensities %>%
  group_by(time) %>%
  drop_na() %>%
  summarise(mean_total_int = mean(TotalIntensity))

ggplot(data=int_new, aes(x=time, y=mean_total_int)) + geom_histogram(stat = "identity", fill='red') +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(title="Average Total Intensity vs. Time")
```
# By this graph,we found out that people are more active between 5 am and 10pm.
# Then, visualize the merged data

```{r}
ggplot(data=merged_data, aes(x=TotalMinutesAsleep, y=SedentaryMinutes)) + 
geom_point(color='darkblue') + geom_smooth() +
  labs(title="Minutes Asleep vs. Sedentary Minutes")
```
Here we can clearly see the negative relationship between Sedentary Minutes and Sleep time.

As an idea: if Bellabeat users want to improve their sleep, Bellabeat app can recommend reducing sedentary time.
# For the weight dataframe

```{r}
ggplot(data=weight, aes(x=WeightKg, y=BMI)) + geom_point(color = 'Blue')+ geom_smooth() +
  labs(title ="Relationship between Weightkg and BMI Intake") 
```
People having 70-90 kg weight are having ideal BMI.
# Plotting the graph between total steps and calculate their BMI as follows 

```{r}
merged_2 <- merge(weight, Activity, FUN=c("Id","Date")) 
head(merged_2) 
ggplot(data=merged_2, aes(x=TotalSteps, y=BMI)) + geom_point(color = 'red') + geom_smooth()+
  labs(title = "Relationship between BMI and Total Steps")
```
People having ideal BMI who are walking with more steps.

# Let's take a look on the relation between total steps and fat
```{r}
merged_2 <- merge(weight, Activity, FUN=c("Id","Date"))
head(merged_2)
ggplot(data=merged_2, aes(x=TotalSteps, y=Fat)) + geom_point(color = 'red') + geom_smooth() + 
  labs(title = "Relationship between Fat and Total Steps")
```
# Those people who are moving with more steps having less amount of fat in their body.
